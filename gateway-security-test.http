### Get USER token
POST http://localhost:8083/realms/order-realm/protocol/openid-connect/token
Content-Type: application/x-www-form-urlencoded

client_id=order-client&
username=user1&
password=password&
grant_type=password

### USER creates order (should succeed)
POST http://localhost:8080/orders
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI5ZkduengtNkV3NWR3M3pILTBPdnlNZWZaY0kyeEUzMDJDN1FzUi1JaWNJIn0.eyJleHAiOjE3NjcwMTgzNTYsImlhdCI6MTc2NzAxODA1NiwianRpIjoiNzY1ZDkzYTgtNjQwZC00ZGM4LWE0ZjQtN2VhNDkwMTFmYjZkIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgzL3JlYWxtcy9vcmRlci1yZWFsbSIsImF1ZCI6ImFjY291bnQiLCJzdWIiOiJkY2U0ZWM5OC01MTdiLTQxN2UtYjA3Ny01MmI0ZTZkZjdlODEiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJvcmRlci1jbGllbnQiLCJzZXNzaW9uX3N0YXRlIjoiMTEyMjk3ZTgtZWJhMi00ZGQxLTk3OTgtZTAzY2IzYmNkYTIxIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbIm9mZmxpbmVfYWNjZXNzIiwiZGVmYXVsdC1yb2xlcy1vcmRlci1yZWFsbSIsInVtYV9hdXRob3JpemF0aW9uIiwiVVNFUiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoiZW1haWwgcHJvZmlsZSIsInNpZCI6IjExMjI5N2U4LWViYTItNGRkMS05Nzk4LWUwM2NiM2JjZGEyMSIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEifQ.oxw9z0dWQyw_NouGredNN-jSV11ZMd4t5Ias0YKT2BhlasE1mmpAN3YHNOqdXdnhG5V1k-NAObTNYbZP3OeY4GbmitJ29l2irYOkMA2JVK9ox3_JV8FCrO8JQEIZPx0gkCHXGXOFdKCg7JTDundqX3VIE1d2DWuJY34j5kPYFQDQmNfqTfNLU8ii9UNgajGk6XFfHIGH4kq2ZGEpPjdSlDlZmVd02MCZvrvjQbM5U9OLRZNQEyqnasR4m4KCIrIg1k6tmuDBrp5GYQX6r4lSaWUD2dnohXEOwLbPI10ZOP41gTROhBn7Euq7SX3wiwCq0grV_uDh1guYBLHcfibgIg
Content-Type: application/json

{
  "product": "USB",
  "quantity": 12
}

### USER tries admin endpoint (should fail)
GET http://localhost:8080/orders/admin
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI5ZkduengtNkV3NWR3M3pILTBPdnlNZWZaY0kyeEUzMDJDN1FzUi1JaWNJIn0.eyJleHAiOjE3NjcwMTgzNTYsImlhdCI6MTc2NzAxODA1NiwianRpIjoiNzY1ZDkzYTgtNjQwZC00ZGM4LWE0ZjQtN2VhNDkwMTFmYjZkIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgzL3JlYWxtcy9vcmRlci1yZWFsbSIsImF1ZCI6ImFjY291bnQiLCJzdWIiOiJkY2U0ZWM5OC01MTdiLTQxN2UtYjA3Ny01MmI0ZTZkZjdlODEiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJvcmRlci1jbGllbnQiLCJzZXNzaW9uX3N0YXRlIjoiMTEyMjk3ZTgtZWJhMi00ZGQxLTk3OTgtZTAzY2IzYmNkYTIxIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbIm9mZmxpbmVfYWNjZXNzIiwiZGVmYXVsdC1yb2xlcy1vcmRlci1yZWFsbSIsInVtYV9hdXRob3JpemF0aW9uIiwiVVNFUiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoiZW1haWwgcHJvZmlsZSIsInNpZCI6IjExMjI5N2U4LWViYTItNGRkMS05Nzk4LWUwM2NiM2JjZGEyMSIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEifQ.oxw9z0dWQyw_NouGredNN-jSV11ZMd4t5Ias0YKT2BhlasE1mmpAN3YHNOqdXdnhG5V1k-NAObTNYbZP3OeY4GbmitJ29l2irYOkMA2JVK9ox3_JV8FCrO8JQEIZPx0gkCHXGXOFdKCg7JTDundqX3VIE1d2DWuJY34j5kPYFQDQmNfqTfNLU8ii9UNgajGk6XFfHIGH4kq2ZGEpPjdSlDlZmVd02MCZvrvjQbM5U9OLRZNQEyqnasR4m4KCIrIg1k6tmuDBrp5GYQX6r4lSaWUD2dnohXEOwLbPI10ZOP41gTROhBn7Euq7SX3wiwCq0grV_uDh1guYBLHcfibgIg

### Get ADMIN token
POST http://localhost:8083/realms/order-realm/protocol/openid-connect/token
Content-Type: application/x-www-form-urlencoded

client_id=order-client&
username=admin1&
password=password&
grant_type=password

### ADMIN accesses admin endpoint (should succeed)
GET http://localhost:8080/orders/admin
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI5ZkduengtNkV3NWR3M3pILTBPdnlNZWZaY0kyeEUzMDJDN1FzUi1JaWNJIn0.eyJleHAiOjE3NjcwMTg1MTcsImlhdCI6MTc2NzAxODIxNywianRpIjoiY2Y0MWYxNjUtZGMzOC00ZTdiLTlkMTktOGI0ODYyMzFjYTdkIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgzL3JlYWxtcy9vcmRlci1yZWFsbSIsImF1ZCI6ImFjY291bnQiLCJzdWIiOiJmMzg4MTcyNS0wMTc1LTQzMTMtODU0Mi03MWM5OWM4ZDgyN2UiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJvcmRlci1jbGllbnQiLCJzZXNzaW9uX3N0YXRlIjoiNjg3MjgxNWMtMDVjOS00MjMzLTkyMjAtMDM2OWQzNzJiMTlkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbIm9mZmxpbmVfYWNjZXNzIiwiZGVmYXVsdC1yb2xlcy1vcmRlci1yZWFsbSIsIkFETUlOIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6ImVtYWlsIHByb2ZpbGUiLCJzaWQiOiI2ODcyODE1Yy0wNWM5LTQyMzMtOTIyMC0wMzY5ZDM3MmIxOWQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsInByZWZlcnJlZF91c2VybmFtZSI6ImFkbWluMSJ9.Sv9bGPbfPBDcoBX0ezuIkIRyVOcvSoq18lM3MFoyyck9yO95jXuyKViQ9bWbN9JpwPMNPUcamPPxiSSmFGDaEWF8GtJcLmxt_hXMBYggob8sUkCA3Agy7UAwzrhhqpWmKcH9aGQb25t-vi5ytv4Z3Mcdhv31Daw9VPpXpLuBN68paBHRDwnZwRPSys5e83Kg1Pij8mIKUaxZYhnb023qiTQaskCL1mm7i4yY6uyprbkgWBgGCY5KBqgWebJTkHSis0igWRB8SYVaxo9ub6GXHgQyeAEXDCZmC3JJhWChW7T0N6hKa5yhTF93MN6ZvbanFQV7Fixo_agdRD6zBLcZOg

### Admin creates order (should succeed)
POST http://localhost:8080/orders
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI5ZkduengtNkV3NWR3M3pILTBPdnlNZWZaY0kyeEUzMDJDN1FzUi1JaWNJIn0.eyJleHAiOjE3NjcwMTg1MTcsImlhdCI6MTc2NzAxODIxNywianRpIjoiY2Y0MWYxNjUtZGMzOC00ZTdiLTlkMTktOGI0ODYyMzFjYTdkIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgzL3JlYWxtcy9vcmRlci1yZWFsbSIsImF1ZCI6ImFjY291bnQiLCJzdWIiOiJmMzg4MTcyNS0wMTc1LTQzMTMtODU0Mi03MWM5OWM4ZDgyN2UiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJvcmRlci1jbGllbnQiLCJzZXNzaW9uX3N0YXRlIjoiNjg3MjgxNWMtMDVjOS00MjMzLTkyMjAtMDM2OWQzNzJiMTlkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbIm9mZmxpbmVfYWNjZXNzIiwiZGVmYXVsdC1yb2xlcy1vcmRlci1yZWFsbSIsIkFETUlOIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6ImVtYWlsIHByb2ZpbGUiLCJzaWQiOiI2ODcyODE1Yy0wNWM5LTQyMzMtOTIyMC0wMzY5ZDM3MmIxOWQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsInByZWZlcnJlZF91c2VybmFtZSI6ImFkbWluMSJ9.Sv9bGPbfPBDcoBX0ezuIkIRyVOcvSoq18lM3MFoyyck9yO95jXuyKViQ9bWbN9JpwPMNPUcamPPxiSSmFGDaEWF8GtJcLmxt_hXMBYggob8sUkCA3Agy7UAwzrhhqpWmKcH9aGQb25t-vi5ytv4Z3Mcdhv31Daw9VPpXpLuBN68paBHRDwnZwRPSys5e83Kg1Pij8mIKUaxZYhnb023qiTQaskCL1mm7i4yY6uyprbkgWBgGCY5KBqgWebJTkHSis0igWRB8SYVaxo9ub6GXHgQyeAEXDCZmC3JJhWChW7T0N6hKa5yhTF93MN6ZvbanFQV7Fixo_agdRD6zBLcZOg
Content-Type: application/json

{
  "product": "Pencil",
  "quantity": 100
}

### No token (should fail /orders)
GET http://localhost:8080/orders

### No token (should fail /orders/admin)
GET http://localhost:8080/orders/admin

### USER queries orders via GraphQL (should succeed)
POST http://localhost:8080/graphql
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI5ZkduengtNkV3NWR3M3pILTBPdnlNZWZaY0kyeEUzMDJDN1FzUi1JaWNJIn0.eyJleHAiOjE3NjcwMjA3MTIsImlhdCI6MTc2NzAyMDQxMiwianRpIjoiMmY5ZGU1NWUtMDA0NC00YTQzLWJjOTUtOTVhYWVhZDFjZDUxIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgzL3JlYWxtcy9vcmRlci1yZWFsbSIsImF1ZCI6ImFjY291bnQiLCJzdWIiOiJkY2U0ZWM5OC01MTdiLTQxN2UtYjA3Ny01MmI0ZTZkZjdlODEiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJvcmRlci1jbGllbnQiLCJzZXNzaW9uX3N0YXRlIjoiYzM3NDRmMWItY2ZiMy00OWY0LWIxMGQtY2Y0ZTkxMDAxNDFhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbIm9mZmxpbmVfYWNjZXNzIiwiZGVmYXVsdC1yb2xlcy1vcmRlci1yZWFsbSIsInVtYV9hdXRob3JpemF0aW9uIiwiVVNFUiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoiZW1haWwgcHJvZmlsZSIsInNpZCI6ImMzNzQ0ZjFiLWNmYjMtNDlmNC1iMTBkLWNmNGU5MTAwMTQxYSIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEifQ.bcX9yFlARThhaDCNUi85yj5SgMzF8f6J70uqDrxxR40XYfF9WLskzzMqSJB9wrPXRlX9PbvxWvwLPkkVGZYrxHDubsTktTRxGsfVpOX0h9DjavqUfZuqnJ1jRfIH18Zw9TEtxQZZhuqk0ebSbd2xzXDI2ZqLVEDsjWnZDzZm2ZDhiKSWbQvhU6qJpvPNC4TdpaW68ms11tmgwKELkAoiviA39XhbFFaPfLG9qeuyddPPwAS30ncqsVCC36HmiP52WE6xgkiDgsVakfLca1onaZ5BOQ-AcoZv8ye9g8Gqt-M_dXJOUAzUoiZaYiHZm8vJdFrBSa7Po09rYrndjbJ7Ug
Content-Type: application/json

{
  "query": "query { orders { id product quantity } }"
}

### USER queries single order by UUID (should succeed)
POST http://localhost:8080/graphql
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI5ZkduengtNkV3NWR3M3pILTBPdnlNZWZaY0kyeEUzMDJDN1FzUi1JaWNJIn0.eyJleHAiOjE3NjcwMjA3MTIsImlhdCI6MTc2NzAyMDQxMiwianRpIjoiMmY5ZGU1NWUtMDA0NC00YTQzLWJjOTUtOTVhYWVhZDFjZDUxIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgzL3JlYWxtcy9vcmRlci1yZWFsbSIsImF1ZCI6ImFjY291bnQiLCJzdWIiOiJkY2U0ZWM5OC01MTdiLTQxN2UtYjA3Ny01MmI0ZTZkZjdlODEiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJvcmRlci1jbGllbnQiLCJzZXNzaW9uX3N0YXRlIjoiYzM3NDRmMWItY2ZiMy00OWY0LWIxMGQtY2Y0ZTkxMDAxNDFhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbIm9mZmxpbmVfYWNjZXNzIiwiZGVmYXVsdC1yb2xlcy1vcmRlci1yZWFsbSIsInVtYV9hdXRob3JpemF0aW9uIiwiVVNFUiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoiZW1haWwgcHJvZmlsZSIsInNpZCI6ImMzNzQ0ZjFiLWNmYjMtNDlmNC1iMTBkLWNmNGU5MTAwMTQxYSIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEifQ.bcX9yFlARThhaDCNUi85yj5SgMzF8f6J70uqDrxxR40XYfF9WLskzzMqSJB9wrPXRlX9PbvxWvwLPkkVGZYrxHDubsTktTRxGsfVpOX0h9DjavqUfZuqnJ1jRfIH18Zw9TEtxQZZhuqk0ebSbd2xzXDI2ZqLVEDsjWnZDzZm2ZDhiKSWbQvhU6qJpvPNC4TdpaW68ms11tmgwKELkAoiviA39XhbFFaPfLG9qeuyddPPwAS30ncqsVCC36HmiP52WE6xgkiDgsVakfLca1onaZ5BOQ-AcoZv8ye9g8Gqt-M_dXJOUAzUoiZaYiHZm8vJdFrBSa7Po09rYrndjbJ7Ug
Content-Type: application/json

{
  "query": "query ($id: ID!) { order(id: $id) { id product quantity } }",
  "variables": {
    "id": "d1e3b7c4-9f88-449c-ba77-0a76bf766876"
  }
}

### ADMIN queries orders via GraphQL (should succeed)
POST http://localhost:8080/graphql
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI5ZkduengtNkV3NWR3M3pILTBPdnlNZWZaY0kyeEUzMDJDN1FzUi1JaWNJIn0.eyJleHAiOjE3NjcwMjEwMjEsImlhdCI6MTc2NzAyMDcyMSwianRpIjoiNzQwMDhkYmQtYmUwNi00ZDAxLWFjZDUtMzlmZmQ5Zjc0NjFhIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgzL3JlYWxtcy9vcmRlci1yZWFsbSIsImF1ZCI6ImFjY291bnQiLCJzdWIiOiJmMzg4MTcyNS0wMTc1LTQzMTMtODU0Mi03MWM5OWM4ZDgyN2UiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJvcmRlci1jbGllbnQiLCJzZXNzaW9uX3N0YXRlIjoiZDMyNGYwYjctNDEyZS00MWZjLTk2YmQtM2EwZTJiOGVjMTRlIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vbG9jYWxob3N0OioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbIm9mZmxpbmVfYWNjZXNzIiwiZGVmYXVsdC1yb2xlcy1vcmRlci1yZWFsbSIsIkFETUlOIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6ImVtYWlsIHByb2ZpbGUiLCJzaWQiOiJkMzI0ZjBiNy00MTJlLTQxZmMtOTZiZC0zYTBlMmI4ZWMxNGUiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsInByZWZlcnJlZF91c2VybmFtZSI6ImFkbWluMSJ9.uY18etptzxuUfcjk2M8e2-GVGCYXw6SiMXvpqfMBXUFft4DrS-zq4iSxABmIZaQz71unsYINt0kUiScBWeF0-oGlggon6DcxdRYPvoqet8R9qWxJvUhiWehm8YW9lLGrT0TLQmFmJNzBRA5gNgWu_lJpZTlEIE3RyUUqQA2I1QiUJPsTWg9F6ZZkLrFkmMMrs7WgNwAQhaNjc3SpuV-t19us3WM7fmRQJJkc-r3gkGTuyOLRF51qcq7ce0SY-vjhw-gq5O9PEQBJkLJOWetosFpoXmcwyDuFzaamM2TSVB6KTyNRgQ0Z56UnwxpNmzLbjO2RSl_QtDd1ln0kS15EnQ
Content-Type: application/json

{
  "query": "query { orders { id product quantity } }"
}

### No token GraphQL access (should fail)
POST http://localhost:8080/graphql
Content-Type: application/json

{
  "query": "query { orders { id } }"
}
